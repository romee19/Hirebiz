<ion-content>
  <div class="list-container">

    <!-- LEGEND -->
    <div class="legend">
      <div class="legend-item">
        <div class="legend-color" style="background:#9e9e9e;"></div>
        <span>No Unit</span>
      </div>
      <div class="legend-item">
        <div class="legend-color" style="background:#4caf50;"></div>
        <span>Single Unit</span>
      </div>
      <div class="legend-item">
        <div class="legend-color" style="background:#ff5722;"></div>
        <span>Dual Monitor</span>
      </div>
      <div class="legend-item">
        <div class="legend-color" style="background:#f44336;"></div>
        <span>No User</span>
      </div>
    </div>

    <!-- EDIT BUTTON -->
    <button
      #editBtn
      class="edit-button"
      type="button"
      (click)="toggleToolbox(editBtn)"
    >
      + Edit
    </button>

    <!-- DRAGGABLE FLOATING TOOLBOX -->
    <div
      class="toolbox"
      *ngIf="toolboxOpen"
      [ngStyle]="{ left: toolboxX + 'px', top: toolboxY + 'px' }"
    >
      <!-- Drag handle (grab here) -->
      <div class="toolbox-handle" (pointerdown)="onDragStart($event)">
        <button class="toolbox-close" type="button" (click)="closeToolbox()">
          <ion-icon name="close-outline"></ion-icon>
        </button>
      </div>

      <!-- Body -->
      <div class="toolbox-body">
        <div class="tool-mid">
          <div class="swatches">
            <div class="sw-row">
              <!-- Tool Pill for adding cubicles -->
              <button class="tool-pill" (click)="addCubicle()"></button>
              <div class="tool-label">Cubicle</div>
            </div>
            <div class="sw-row">
              <button
                class="swatch"
                type="button"
                [style.background]="'#9e9e9e'"
                [class.active]="selectedColor === '#9e9e9e'"
                (click)="selectColor('#9e9e9e')"
              ></button>

              <button
                class="swatch"
                type="button"
                [style.background]="'#4caf50'"
                [class.active]="selectedColor === '#4caf50'"
                (click)="selectColor('#4caf50')"
              ></button>
            </div>

            <div class="sw-row">
              <button
                class="swatch"
                type="button"
                [style.background]="'#000000'"
                [class.active]="selectedColor === '#000000'"
                (click)="selectColor('#000000')"
              ></button>

              <button
                class="swatch"
                type="button"
                [style.background]="'#f44336'"
                [class.active]="selectedColor === '#f44336'"
                (click)="selectColor('#f44336')"
              ></button>
            </div>

            <div class="sw-row">
              <button
                class="swatch"
                type="button"
                [style.background]="'#ff5722'"
                [class.active]="selectedColor === '#ff5722'"
                (click)="selectColor('#ff5722')"
              ></button>
            </div>
          </div>

          <button class="brush-btn" type="button">
            <ion-icon name="color-fill"></ion-icon>
          </button>
        </div>

        <div class="tool-footer">
          <button class="save-btn" type="button" (click)="saveEditSettings()">
            Save
          </button>
        </div>
      </div>
    </div>

    <!-- Display generated cubicles dynamically -->
    <div class="cubicle" *ngFor="let cubicle of cubicles" [ngStyle]="{ left: cubicle.x + 'px', top: cubicle.y + 'px' }">
      {{ cubicle.label }}
    </div>

  </div>
</ion-content>